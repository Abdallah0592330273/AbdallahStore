[2025-12-27 10:55:32.590] [Store.API] [User: ] INF: Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
[2025-12-27 10:55:32.626] [Store.API] [User: ] INF: Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
[2025-12-27 10:55:32.703] [Store.API] [User: ] INF: Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
[2025-12-27 10:55:32.783] [Store.API] [User: ] INF: Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
[2025-12-27 10:55:32.804] [Store.API] [User: ] INF: Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
[2025-12-27 10:55:32.806] [Store.API] [User: ] INF: Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
[2025-12-27 10:55:32.829] [Store.API] [User: ] INF: Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
[2025-12-27 10:55:32.838] [Store.API] [User: ] INF: No migrations were applied. The database is already up to date.
[2025-12-27 10:55:32.847] [Store.API] [User: ] INF: Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
[2025-12-27 10:55:33.357] [Store.API] [User: ] INF: Executed DbCommand (110ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [AspNetRoles] AS [a]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
[2025-12-27 10:55:33.367] [Store.API] [User: ] INF: Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [AspNetUsers] AS [a]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
[2025-12-27 10:55:33.373] [Store.API] [User: ] INF: Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Addresses] AS [a]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
[2025-12-27 10:55:33.378] [Store.API] [User: ] INF: Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductBrands] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
[2025-12-27 10:55:33.383] [Store.API] [User: ] INF: Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductTypes] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
[2025-12-27 10:55:33.388] [Store.API] [User: ] INF: Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
[2025-12-27 10:55:33.393] [Store.API] [User: ] INF: Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Products] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
[2025-12-27 10:55:33.482] [Store.API] [User: ] INF: User profile is available. Using 'C:\Users\acc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-27 10:55:33.600] [Store.API] [User: ] INF: Now listening on: http://localhost:5025
[2025-12-27 10:55:33.602] [Store.API] [User: ] INF: Application started. Press Ctrl+C to shut down.
[2025-12-27 10:55:33.602] [Store.API] [User: ] INF: Hosting environment: Development
[2025-12-27 10:55:33.602] [Store.API] [User: ] INF: Content root path: C:\Users\acc\Desktop\New Folder\Store.API
[2025-12-27 13:35:41.370] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/swagger/index.html - null null
[2025-12-27 13:35:41.799] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/swagger/index.html - 200 null text/html;charset=utf-8 462.9662ms
[2025-12-27 13:35:41.953] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/swagger/v1/swagger.json - null null
[2025-12-27 13:35:42.251] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 299.1663ms
[2025-12-27 14:49:54.496] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/api/Category - null null
[2025-12-27 14:49:54.588] [Store.API] [User: ] WRN: Failed to determine the https port for redirect.
[2025-12-27 14:49:54.748] [Store.API] [User: Guest] INF: Executing endpoint 'Store.API.Controllers.CategoryController.GetCategories (Store.API)'
[2025-12-27 14:49:54.830] [Store.API] [User: Guest] INF: Route matched with {action = "GetCategories", controller = "Category"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IReadOnlyList`1[Store.Application.Dtos.CategoryDto]]] GetCategories() on controller Store.API.Controllers.CategoryController (Store.API).
[2025-12-27 14:49:55.365] [Store.API] [User: Guest] INF: Executed DbCommand (67ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedBy], [c].[CreatedDate], [c].[Description], [c].[IsDeleted], [c].[LastModifiedBy], [c].[LastModifiedDate], [c].[Name]
FROM [Categories] AS [c]
[2025-12-27 14:49:55.466] [Store.API] [User: Guest] INF: Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Store.Application.Dtos.CategoryDto, Store.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-27 14:49:55.496] [Store.API] [User: Guest] INF: Executed action Store.API.Controllers.CategoryController.GetCategories (Store.API) in 659.7489ms
[2025-12-27 14:49:55.497] [Store.API] [User: Guest] INF: Executed endpoint 'Store.API.Controllers.CategoryController.GetCategories (Store.API)'
[2025-12-27 14:49:55.501] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/api/Category - 200 null application/json; charset=utf-8 1009.4573ms
[2025-12-27 14:56:29.138] [Store.API] [User: ] INF: Request starting HTTP/1.1 POST http://localhost:5025/api/Category - application/json 61
[2025-12-27 14:56:29.146] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 14:56:29.146] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 14:56:29.153] [Store.API] [User: ] INF: Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin|SuperAdmin)
[2025-12-27 14:56:29.160] [Store.API] [User: ] INF: AuthenticationScheme: Bearer was challenged.
[2025-12-27 14:56:29.161] [Store.API] [User: ] INF: Request finished HTTP/1.1 POST http://localhost:5025/api/Category - 401 0 null 22.9035ms
[2025-12-27 15:01:50.269] [Store.API] [User: ] INF: Request starting HTTP/1.1 POST http://localhost:5025/api/Account/login - application/json 63
[2025-12-27 15:01:50.271] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:01:50.272] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:01:50.278] [Store.API] [User: Guest] INF: Executing endpoint 'Store.API.Controllers.AccountController.Login (Store.API)'
[2025-12-27 15:01:50.300] [Store.API] [User: Guest] INF: Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.UserDto]] Login(Store.API.Controllers.LoginDto) on controller Store.API.Controllers.AccountController (Store.API).
[2025-12-27 15:01:51.344] [Store.API] [User: Guest] INF: Executed DbCommand (79ms) [Parameters=[@normalizedEmail='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedBy], [a].[CreatedDate], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsDeleted], [a].[LastModifiedBy], [a].[LastModifiedDate], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[PicturePublicId], [a].[PictureUrl], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @normalizedEmail
[2025-12-27 15:01:51.573] [Store.API] [User: Guest] INF: Executed DbCommand (18ms) [Parameters=[@userId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @userId
[2025-12-27 15:01:51.617] [Store.API] [User: Guest] INF: Executing ObjectResult, writing value of type 'Store.Application.Dtos.UserDto'.
[2025-12-27 15:01:51.619] [Store.API] [User: Guest] INF: Executed action Store.API.Controllers.AccountController.Login (Store.API) in 1318.4637ms
[2025-12-27 15:01:51.619] [Store.API] [User: Guest] INF: Executed endpoint 'Store.API.Controllers.AccountController.Login (Store.API)'
[2025-12-27 15:01:51.624] [Store.API] [User: ] INF: Request finished HTTP/1.1 POST http://localhost:5025/api/Account/login - 200 null application/json; charset=utf-8 1354.0915ms
[2025-12-27 15:02:10.824] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/api/Basket - null null
[2025-12-27 15:02:10.872] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.BasketController.GetBasketById (Store.API)'
[2025-12-27 15:02:10.877] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "GetBasketById", controller = "Basket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.CartDto]] GetBasketById() on controller Store.API.Controllers.BasketController (Store.API).
[2025-12-27 15:02:11.011] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (31ms) [Parameters=[@buyerId='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[BuyerId], [c1].[ClientSecret], [c1].[CreatedBy], [c1].[CreatedDate], [c1].[IsDeleted], [c1].[LastModifiedBy], [c1].[LastModifiedDate], [c1].[PaymentIntentId], [c0].[Id], [c0].[CartId], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[LastModifiedBy], [c0].[LastModifiedDate], [c0].[ProductId], [c0].[Quantity]
FROM (
    SELECT TOP(1) [c].[Id], [c].[BuyerId], [c].[ClientSecret], [c].[CreatedBy], [c].[CreatedDate], [c].[IsDeleted], [c].[LastModifiedBy], [c].[LastModifiedDate], [c].[PaymentIntentId]
    FROM [Carts] AS [c]
    WHERE [c].[BuyerId] = @buyerId
) AS [c1]
LEFT JOIN [CartItems] AS [c0] ON [c1].[Id] = [c0].[CartId]
ORDER BY [c1].[Id]
[2025-12-27 15:02:11.023] [Store.API] [User: superadmin@store.com] INF: Executing OkObjectResult, writing value of type 'Store.Application.Dtos.CartDto'.
[2025-12-27 15:02:11.035] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.BasketController.GetBasketById (Store.API) in 157.2944ms
[2025-12-27 15:02:11.035] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.BasketController.GetBasketById (Store.API)'
[2025-12-27 15:02:11.035] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/api/Basket - 200 null application/json; charset=utf-8 210.7176ms
[2025-12-27 15:02:28.282] [Store.API] [User: ] INF: Request starting HTTP/1.1 POST http://localhost:5025/api/Category - application/json 61
[2025-12-27 15:02:28.283] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:02:28.283] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:02:28.286] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.CategoryController.CreateCategory (Store.API)'
[2025-12-27 15:02:28.298] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "CreateCategory", controller = "Category"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.CategoryDto]] CreateCategory(Store.Application.Dtos.CategoryDto) on controller Store.API.Controllers.CategoryController (Store.API).
[2025-12-27 15:02:28.455] [Store.API] [User: superadmin@store.com] ERR: Failed executing DbCommand (41ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Categories] ([Id], [CreatedBy], [CreatedDate], [Description], [IsDeleted], [LastModifiedBy], [LastModifiedDate], [Name])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
[2025-12-27 15:02:28.539] [Store.API] [User: superadmin@store.com] ERR: An exception occurred in the database while saving changes for context type 'Store.Infrastructure.Data.StoreContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Categories' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:fd708bfb-c9df-4341-b684-d897dc229e3b
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Categories' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:fd708bfb-c9df-4341-b684-d897dc229e3b
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2025-12-27 15:02:28.543] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.CategoryController.CreateCategory (Store.API) in 244.317ms
[2025-12-27 15:02:28.544] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.CategoryController.CreateCategory (Store.API)'
[2025-12-27 15:02:28.545] [Store.API] [User: ] ERR: An unhandled exception has occurred while executing the request: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Categories' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:fd708bfb-c9df-4341-b684-d897dc229e3b
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Store.Infrastructure.Data.UnitOfWork.Complete() in C:\Users\acc\Desktop\New Folder\Store.Infrastructure\Data\Repositories.cs:line 122
   at Store.Services.CategoryService.CreateCategoryAsync(Category category) in C:\Users\acc\Desktop\New Folder\Store.Services\CategoryService.cs:line 27
   at Store.API.Controllers.CategoryController.CreateCategory(CategoryDto categoryDto) in C:\Users\acc\Desktop\New Folder\Store.API\Controllers\CategoryController.cs:line 44
   at lambda_method347(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Store.API.Middleware.SerilogUserEnricherMiddleware.InvokeAsync(HttpContext context) in C:\Users\acc\Desktop\New Folder\Store.API\Middleware\SerilogUserEnricherMiddleware.cs:line 21
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Store.API.Middleware.ExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\acc\Desktop\New Folder\Store.API\Middleware\ExceptionMiddleware.cs:line 24
[2025-12-27 15:02:28.598] [Store.API] [User: ] INF: Request finished HTTP/1.1 POST http://localhost:5025/api/Category - 500 null application/json 316.249ms
[2025-12-27 15:04:33.492] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/api/Category - null null
[2025-12-27 15:04:33.493] [Store.API] [User: Guest] INF: Executing endpoint 'Store.API.Controllers.CategoryController.GetCategories (Store.API)'
[2025-12-27 15:04:33.493] [Store.API] [User: Guest] INF: Route matched with {action = "GetCategories", controller = "Category"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IReadOnlyList`1[Store.Application.Dtos.CategoryDto]]] GetCategories() on controller Store.API.Controllers.CategoryController (Store.API).
[2025-12-27 15:04:33.517] [Store.API] [User: Guest] INF: Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedBy], [c].[CreatedDate], [c].[Description], [c].[IsDeleted], [c].[LastModifiedBy], [c].[LastModifiedDate], [c].[Name]
FROM [Categories] AS [c]
[2025-12-27 15:04:33.518] [Store.API] [User: Guest] INF: Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Store.Application.Dtos.CategoryDto, Store.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-27 15:04:33.519] [Store.API] [User: Guest] INF: Executed action Store.API.Controllers.CategoryController.GetCategories (Store.API) in 25.6648ms
[2025-12-27 15:04:33.519] [Store.API] [User: Guest] INF: Executed endpoint 'Store.API.Controllers.CategoryController.GetCategories (Store.API)'
[2025-12-27 15:04:33.519] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/api/Category - 200 null application/json; charset=utf-8 26.6941ms
[2025-12-27 15:04:33.615] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/favicon.ico - null null
[2025-12-27 15:04:33.618] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/favicon.ico - 404 0 null 2.6165ms
[2025-12-27 15:04:33.620] [Store.API] [User: ] INF: Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5025/favicon.ico, Response status code: 404
[2025-12-27 15:09:57.492] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/swagger/index.html - null null
[2025-12-27 15:09:57.499] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/swagger/index.html - 200 null text/html;charset=utf-8 6.7597ms
[2025-12-27 15:09:57.644] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/swagger/v1/swagger.json - null null
[2025-12-27 15:09:57.692] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 47.9486ms
[2025-12-27 15:10:09.700] [Store.API] [User: ] INF: Request starting HTTP/1.1 POST http://localhost:5025/api/Account/login - application/json 63
[2025-12-27 15:10:09.702] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:10:09.702] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:10:09.703] [Store.API] [User: Guest] INF: Executing endpoint 'Store.API.Controllers.AccountController.Login (Store.API)'
[2025-12-27 15:10:09.704] [Store.API] [User: Guest] INF: Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.UserDto]] Login(Store.API.Controllers.LoginDto) on controller Store.API.Controllers.AccountController (Store.API).
[2025-12-27 15:10:09.737] [Store.API] [User: Guest] INF: Executed DbCommand (8ms) [Parameters=[@normalizedEmail='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedBy], [a].[CreatedDate], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsDeleted], [a].[LastModifiedBy], [a].[LastModifiedDate], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[PicturePublicId], [a].[PictureUrl], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @normalizedEmail
[2025-12-27 15:10:09.810] [Store.API] [User: Guest] INF: Executed DbCommand (5ms) [Parameters=[@userId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @userId
[2025-12-27 15:10:09.812] [Store.API] [User: Guest] INF: Executing ObjectResult, writing value of type 'Store.Application.Dtos.UserDto'.
[2025-12-27 15:10:09.813] [Store.API] [User: Guest] INF: Executed action Store.API.Controllers.AccountController.Login (Store.API) in 109.2945ms
[2025-12-27 15:10:09.813] [Store.API] [User: Guest] INF: Executed endpoint 'Store.API.Controllers.AccountController.Login (Store.API)'
[2025-12-27 15:10:09.814] [Store.API] [User: ] INF: Request finished HTTP/1.1 POST http://localhost:5025/api/Account/login - 200 null application/json; charset=utf-8 113.8192ms
[2025-12-27 15:10:11.631] [Store.API] [User: ] INF: Request starting HTTP/1.1 POST http://localhost:5025/api/Account/login - application/json 63
[2025-12-27 15:10:11.631] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:10:11.631] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:10:11.631] [Store.API] [User: Guest] INF: Executing endpoint 'Store.API.Controllers.AccountController.Login (Store.API)'
[2025-12-27 15:10:11.631] [Store.API] [User: Guest] INF: Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.UserDto]] Login(Store.API.Controllers.LoginDto) on controller Store.API.Controllers.AccountController (Store.API).
[2025-12-27 15:10:11.661] [Store.API] [User: Guest] INF: Executed DbCommand (5ms) [Parameters=[@normalizedEmail='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedBy], [a].[CreatedDate], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsDeleted], [a].[LastModifiedBy], [a].[LastModifiedDate], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[PicturePublicId], [a].[PictureUrl], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @normalizedEmail
[2025-12-27 15:10:11.772] [Store.API] [User: Guest] INF: Executed DbCommand (5ms) [Parameters=[@userId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @userId
[2025-12-27 15:10:11.772] [Store.API] [User: Guest] INF: Executing ObjectResult, writing value of type 'Store.Application.Dtos.UserDto'.
[2025-12-27 15:10:11.773] [Store.API] [User: Guest] INF: Executed action Store.API.Controllers.AccountController.Login (Store.API) in 141.6073ms
[2025-12-27 15:10:11.773] [Store.API] [User: Guest] INF: Executed endpoint 'Store.API.Controllers.AccountController.Login (Store.API)'
[2025-12-27 15:10:11.773] [Store.API] [User: ] INF: Request finished HTTP/1.1 POST http://localhost:5025/api/Account/login - 200 null application/json; charset=utf-8 142.2938ms
[2025-12-27 15:10:35.905] [Store.API] [User: ] INF: Request starting HTTP/1.1 POST http://localhost:5025/api/Category - application/json 60
[2025-12-27 15:10:35.906] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:10:35.906] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:10:35.907] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.CategoryController.CreateCategory (Store.API)'
[2025-12-27 15:10:35.907] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "CreateCategory", controller = "Category"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.CategoryDto]] CreateCategory(Store.Application.Dtos.CategoryDto) on controller Store.API.Controllers.CategoryController (Store.API).
[2025-12-27 15:10:35.951] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (25ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Categories] ([CreatedBy], [CreatedDate], [Description], [IsDeleted], [LastModifiedBy], [LastModifiedDate], [Name])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
[2025-12-27 15:10:35.979] [Store.API] [User: superadmin@store.com] INF: Executing OkObjectResult, writing value of type 'Store.Application.Dtos.CategoryDto'.
[2025-12-27 15:10:35.980] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.CategoryController.CreateCategory (Store.API) in 72.7768ms
[2025-12-27 15:10:35.980] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.CategoryController.CreateCategory (Store.API)'
[2025-12-27 15:10:35.980] [Store.API] [User: ] INF: Request finished HTTP/1.1 POST http://localhost:5025/api/Category - 200 null application/json; charset=utf-8 74.6022ms
[2025-12-27 15:11:07.888] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/api/Category/1002 - null null
[2025-12-27 15:11:07.893] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.CategoryController.GetCategory (Store.API)'
[2025-12-27 15:11:07.901] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "GetCategory", controller = "Category"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.CategoryDto]] GetCategory(Int32) on controller Store.API.Controllers.CategoryController (Store.API).
[2025-12-27 15:11:07.944] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (12ms) [Parameters=[@p='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[CreatedBy], [c].[CreatedDate], [c].[Description], [c].[IsDeleted], [c].[LastModifiedBy], [c].[LastModifiedDate], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @p
[2025-12-27 15:11:07.945] [Store.API] [User: superadmin@store.com] INF: Executing OkObjectResult, writing value of type 'Store.Application.Dtos.CategoryDto'.
[2025-12-27 15:11:07.945] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.CategoryController.GetCategory (Store.API) in 43.7178ms
[2025-12-27 15:11:07.945] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.CategoryController.GetCategory (Store.API)'
[2025-12-27 15:11:07.945] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/api/Category/1002 - 200 null application/json; charset=utf-8 57.2908ms
[2025-12-27 15:11:25.147] [Store.API] [User: ] INF: Request starting HTTP/1.1 PUT http://localhost:5025/api/Category/1002 - application/json 61
[2025-12-27 15:11:25.148] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:11:25.148] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:11:25.149] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.CategoryController.UpdateCategory (Store.API)'
[2025-12-27 15:11:25.158] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "UpdateCategory", controller = "Category"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.CategoryDto]] UpdateCategory(Int32, Store.Application.Dtos.CategoryDto) on controller Store.API.Controllers.CategoryController (Store.API).
[2025-12-27 15:11:25.165] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (2ms) [Parameters=[@p='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[CreatedBy], [c].[CreatedDate], [c].[Description], [c].[IsDeleted], [c].[LastModifiedBy], [c].[LastModifiedDate], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @p
[2025-12-27 15:11:25.184] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (13ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Categories] SET [CreatedBy] = @p0, [CreatedDate] = @p1, [Description] = @p2, [IsDeleted] = @p3, [LastModifiedBy] = @p4, [LastModifiedDate] = @p5, [Name] = @p6
OUTPUT 1
WHERE [Id] = @p7;
[2025-12-27 15:11:25.185] [Store.API] [User: superadmin@store.com] INF: Executing OkObjectResult, writing value of type 'Store.Application.Dtos.CategoryDto'.
[2025-12-27 15:11:25.186] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.CategoryController.UpdateCategory (Store.API) in 27.8809ms
[2025-12-27 15:11:25.186] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.CategoryController.UpdateCategory (Store.API)'
[2025-12-27 15:11:25.186] [Store.API] [User: ] INF: Request finished HTTP/1.1 PUT http://localhost:5025/api/Category/1002 - 200 null application/json; charset=utf-8 38.4512ms
[2025-12-27 15:11:46.163] [Store.API] [User: ] INF: Request starting HTTP/1.1 DELETE http://localhost:5025/api/Category/1002 - null null
[2025-12-27 15:11:46.163] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:11:46.163] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:11:46.164] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.CategoryController.DeleteCategory (Store.API)'
[2025-12-27 15:11:46.176] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "DeleteCategory", controller = "Category"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] DeleteCategory(Int32) on controller Store.API.Controllers.CategoryController (Store.API).
[2025-12-27 15:11:46.182] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (2ms) [Parameters=[@p='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[CreatedBy], [c].[CreatedDate], [c].[Description], [c].[IsDeleted], [c].[LastModifiedBy], [c].[LastModifiedDate], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @p
[2025-12-27 15:11:46.236] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (49ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Categories]
OUTPUT 1
WHERE [Id] = @p0;
[2025-12-27 15:11:46.245] [Store.API] [User: superadmin@store.com] INF: Executing StatusCodeResult, setting HTTP status code 200
[2025-12-27 15:11:46.246] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.CategoryController.DeleteCategory (Store.API) in 69.0558ms
[2025-12-27 15:11:46.246] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.CategoryController.DeleteCategory (Store.API)'
[2025-12-27 15:11:46.246] [Store.API] [User: ] INF: Request finished HTTP/1.1 DELETE http://localhost:5025/api/Category/1002 - 200 0 null 83.0861ms
[2025-12-27 15:12:17.262] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/api/Products - null null
[2025-12-27 15:12:17.263] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.GetProducts (Store.API)'
[2025-12-27 15:12:17.277] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "GetProducts", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IReadOnlyList`1[Store.Application.Dtos.ProductToReturnDto]]] GetProducts() on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:12:17.321] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CreatedBy], [p].[CreatedDate], [p].[Description], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name], [p].[PicturePublicId], [p].[PictureUrl], [p].[Price], [p].[ProductBrandId], [p].[ProductTypeId], [p0].[Id], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[LastModifiedBy], [p0].[LastModifiedDate], [p0].[Name], [p1].[Id], [p1].[CreatedBy], [p1].[CreatedDate], [p1].[IsDeleted], [p1].[LastModifiedBy], [p1].[LastModifiedDate], [p1].[Name], [c].[Id], [c].[CreatedBy], [c].[CreatedDate], [c].[Description], [c].[IsDeleted], [c].[LastModifiedBy], [c].[LastModifiedDate], [c].[Name]
FROM [Products] AS [p]
INNER JOIN [ProductTypes] AS [p0] ON [p].[ProductTypeId] = [p0].[Id]
INNER JOIN [ProductBrands] AS [p1] ON [p].[ProductBrandId] = [p1].[Id]
INNER JOIN [Categories] AS [c] ON [p].[CategoryId] = [c].[Id]
[2025-12-27 15:12:17.393] [Store.API] [User: superadmin@store.com] INF: Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Store.Application.Dtos.ProductToReturnDto, Store.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-27 15:12:17.397] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.GetProducts (Store.API) in 120.3485ms
[2025-12-27 15:12:17.397] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.GetProducts (Store.API)'
[2025-12-27 15:12:17.397] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/api/Products - 200 null application/json; charset=utf-8 134.7278ms
[2025-12-27 15:13:22.337] [Store.API] [User: ] INF: Request starting HTTP/1.1 POST http://localhost:5025/api/Products - application/json 149
[2025-12-27 15:13:22.337] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:13:22.338] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:13:22.338] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.CreateProduct (Store.API)'
[2025-12-27 15:13:22.355] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.ProductToReturnDto]] CreateProduct(Store.Application.Dtos.ProductCreateDto) on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:13:22.393] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Products] ([CategoryId], [CreatedBy], [CreatedDate], [Description], [IsDeleted], [LastModifiedBy], [LastModifiedDate], [Name], [PicturePublicId], [PictureUrl], [Price], [ProductBrandId], [ProductTypeId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
[2025-12-27 15:13:22.400] [Store.API] [User: superadmin@store.com] INF: Executing OkObjectResult, writing value of type 'Store.Application.Dtos.ProductToReturnDto'.
[2025-12-27 15:13:22.400] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.CreateProduct (Store.API) in 45.1168ms
[2025-12-27 15:13:22.400] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.CreateProduct (Store.API)'
[2025-12-27 15:13:22.400] [Store.API] [User: ] INF: Request finished HTTP/1.1 POST http://localhost:5025/api/Products - 200 null application/json; charset=utf-8 63.7775ms
[2025-12-27 15:13:49.921] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/api/Products/6 - null null
[2025-12-27 15:13:49.922] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.GetProduct (Store.API)'
[2025-12-27 15:13:49.931] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "GetProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.ProductToReturnDto]] GetProduct(Int32) on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:13:49.965] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (13ms) [Parameters=[@id='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CreatedBy], [p].[CreatedDate], [p].[Description], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name], [p].[PicturePublicId], [p].[PictureUrl], [p].[Price], [p].[ProductBrandId], [p].[ProductTypeId], [p0].[Id], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[LastModifiedBy], [p0].[LastModifiedDate], [p0].[Name], [p1].[Id], [p1].[CreatedBy], [p1].[CreatedDate], [p1].[IsDeleted], [p1].[LastModifiedBy], [p1].[LastModifiedDate], [p1].[Name], [c].[Id], [c].[CreatedBy], [c].[CreatedDate], [c].[Description], [c].[IsDeleted], [c].[LastModifiedBy], [c].[LastModifiedDate], [c].[Name]
FROM [Products] AS [p]
INNER JOIN [ProductTypes] AS [p0] ON [p].[ProductTypeId] = [p0].[Id]
INNER JOIN [ProductBrands] AS [p1] ON [p].[ProductBrandId] = [p1].[Id]
INNER JOIN [Categories] AS [c] ON [p].[CategoryId] = [c].[Id]
WHERE [p].[Id] = @id
[2025-12-27 15:13:49.966] [Store.API] [User: superadmin@store.com] INF: Executing OkObjectResult, writing value of type 'Store.Application.Dtos.ProductToReturnDto'.
[2025-12-27 15:13:49.966] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.GetProduct (Store.API) in 34.8547ms
[2025-12-27 15:13:49.966] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.GetProduct (Store.API)'
[2025-12-27 15:13:49.966] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/api/Products/6 - 200 null application/json; charset=utf-8 45.2908ms
[2025-12-27 15:14:15.394] [Store.API] [User: ] INF: Request starting HTTP/1.1 PUT http://localhost:5025/api/Products/6 - application/json 153
[2025-12-27 15:14:15.395] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:14:15.395] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:14:15.395] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:14:15.412] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "UpdateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.ProductToReturnDto]] UpdateProduct(Int32, Store.Application.Dtos.ProductCreateDto) on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:14:15.423] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (2ms) [Parameters=[@p='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CreatedBy], [p].[CreatedDate], [p].[Description], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name], [p].[PicturePublicId], [p].[PictureUrl], [p].[Price], [p].[ProductBrandId], [p].[ProductTypeId]
FROM [Products] AS [p]
WHERE [p].[Id] = @p
[2025-12-27 15:14:15.451] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (25ms) [Parameters=[@p13='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Products] SET [CategoryId] = @p0, [CreatedBy] = @p1, [CreatedDate] = @p2, [Description] = @p3, [IsDeleted] = @p4, [LastModifiedBy] = @p5, [LastModifiedDate] = @p6, [Name] = @p7, [PicturePublicId] = @p8, [PictureUrl] = @p9, [Price] = @p10, [ProductBrandId] = @p11, [ProductTypeId] = @p12
OUTPUT 1
WHERE [Id] = @p13;
[2025-12-27 15:14:15.456] [Store.API] [User: superadmin@store.com] ERR: An exception occurred in the database while saving changes for context type 'Store.Infrastructure.Data.StoreContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_Categories_CategoryId". The conflict occurred in database "Store01", table "dbo.Categories", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_Categories_CategoryId". The conflict occurred in database "Store01", table "dbo.Categories", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2025-12-27 15:14:15.457] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.UpdateProduct (Store.API) in 44.4937ms
[2025-12-27 15:14:15.457] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:14:15.457] [Store.API] [User: ] ERR: An unhandled exception has occurred while executing the request: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_Categories_CategoryId". The conflict occurred in database "Store01", table "dbo.Categories", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Store.Infrastructure.Data.UnitOfWork.Complete() in C:\Users\acc\Desktop\New Folder\Store.Infrastructure\Data\Repositories.cs:line 122
   at Store.Services.ProductService.UpdateProductAsync(Int32 id, Product product) in C:\Users\acc\Desktop\New Folder\Store.Services\ProductService.cs:line 66
   at Store.API.Controllers.ProductsController.UpdateProduct(Int32 id, ProductCreateDto productDto) in C:\Users\acc\Desktop\New Folder\Store.API\Controllers\ProductsController.cs:line 78
   at lambda_method772(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Store.API.Middleware.SerilogUserEnricherMiddleware.InvokeAsync(HttpContext context) in C:\Users\acc\Desktop\New Folder\Store.API\Middleware\SerilogUserEnricherMiddleware.cs:line 21
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Store.API.Middleware.ExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\acc\Desktop\New Folder\Store.API\Middleware\ExceptionMiddleware.cs:line 24
[2025-12-27 15:14:15.461] [Store.API] [User: ] INF: Request finished HTTP/1.1 PUT http://localhost:5025/api/Products/6 - 500 null application/json 67.3966ms
[2025-12-27 15:14:23.059] [Store.API] [User: ] INF: Request starting HTTP/1.1 PUT http://localhost:5025/api/Products/6 - application/json 153
[2025-12-27 15:14:23.059] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:14:23.059] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:14:23.060] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:14:23.060] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "UpdateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.ProductToReturnDto]] UpdateProduct(Int32, Store.Application.Dtos.ProductCreateDto) on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:14:23.063] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (1ms) [Parameters=[@p='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CreatedBy], [p].[CreatedDate], [p].[Description], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name], [p].[PicturePublicId], [p].[PictureUrl], [p].[Price], [p].[ProductBrandId], [p].[ProductTypeId]
FROM [Products] AS [p]
WHERE [p].[Id] = @p
[2025-12-27 15:14:23.075] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (2ms) [Parameters=[@p13='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Products] SET [CategoryId] = @p0, [CreatedBy] = @p1, [CreatedDate] = @p2, [Description] = @p3, [IsDeleted] = @p4, [LastModifiedBy] = @p5, [LastModifiedDate] = @p6, [Name] = @p7, [PicturePublicId] = @p8, [PictureUrl] = @p9, [Price] = @p10, [ProductBrandId] = @p11, [ProductTypeId] = @p12
OUTPUT 1
WHERE [Id] = @p13;
[2025-12-27 15:14:23.076] [Store.API] [User: superadmin@store.com] ERR: An exception occurred in the database while saving changes for context type 'Store.Infrastructure.Data.StoreContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_Categories_CategoryId". The conflict occurred in database "Store01", table "dbo.Categories", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_Categories_CategoryId". The conflict occurred in database "Store01", table "dbo.Categories", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2025-12-27 15:14:23.077] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.UpdateProduct (Store.API) in 17.0592ms
[2025-12-27 15:14:23.077] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:14:23.077] [Store.API] [User: ] ERR: An unhandled exception has occurred while executing the request: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_Categories_CategoryId". The conflict occurred in database "Store01", table "dbo.Categories", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Store.Infrastructure.Data.UnitOfWork.Complete() in C:\Users\acc\Desktop\New Folder\Store.Infrastructure\Data\Repositories.cs:line 122
   at Store.Services.ProductService.UpdateProductAsync(Int32 id, Product product) in C:\Users\acc\Desktop\New Folder\Store.Services\ProductService.cs:line 66
   at Store.API.Controllers.ProductsController.UpdateProduct(Int32 id, ProductCreateDto productDto) in C:\Users\acc\Desktop\New Folder\Store.API\Controllers\ProductsController.cs:line 78
   at lambda_method772(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Store.API.Middleware.SerilogUserEnricherMiddleware.InvokeAsync(HttpContext context) in C:\Users\acc\Desktop\New Folder\Store.API\Middleware\SerilogUserEnricherMiddleware.cs:line 21
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Store.API.Middleware.ExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\acc\Desktop\New Folder\Store.API\Middleware\ExceptionMiddleware.cs:line 24
[2025-12-27 15:14:23.081] [Store.API] [User: ] INF: Request finished HTTP/1.1 PUT http://localhost:5025/api/Products/6 - 500 null application/json 22.0942ms
[2025-12-27 15:14:35.044] [Store.API] [User: ] INF: Request starting HTTP/1.1 PUT http://localhost:5025/api/Products/6 - application/json 153
[2025-12-27 15:14:35.044] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:14:35.044] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:14:35.045] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:14:35.045] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "UpdateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.ProductToReturnDto]] UpdateProduct(Int32, Store.Application.Dtos.ProductCreateDto) on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:14:35.047] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (1ms) [Parameters=[@p='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CreatedBy], [p].[CreatedDate], [p].[Description], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name], [p].[PicturePublicId], [p].[PictureUrl], [p].[Price], [p].[ProductBrandId], [p].[ProductTypeId]
FROM [Products] AS [p]
WHERE [p].[Id] = @p
[2025-12-27 15:14:35.050] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (1ms) [Parameters=[@p13='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Products] SET [CategoryId] = @p0, [CreatedBy] = @p1, [CreatedDate] = @p2, [Description] = @p3, [IsDeleted] = @p4, [LastModifiedBy] = @p5, [LastModifiedDate] = @p6, [Name] = @p7, [PicturePublicId] = @p8, [PictureUrl] = @p9, [Price] = @p10, [ProductBrandId] = @p11, [ProductTypeId] = @p12
OUTPUT 1
WHERE [Id] = @p13;
[2025-12-27 15:14:35.051] [Store.API] [User: superadmin@store.com] ERR: An exception occurred in the database while saving changes for context type 'Store.Infrastructure.Data.StoreContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_Categories_CategoryId". The conflict occurred in database "Store01", table "dbo.Categories", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_Categories_CategoryId". The conflict occurred in database "Store01", table "dbo.Categories", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2025-12-27 15:14:35.052] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.UpdateProduct (Store.API) in 6.9457ms
[2025-12-27 15:14:35.052] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:14:35.052] [Store.API] [User: ] ERR: An unhandled exception has occurred while executing the request: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_Categories_CategoryId". The conflict occurred in database "Store01", table "dbo.Categories", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Store.Infrastructure.Data.UnitOfWork.Complete() in C:\Users\acc\Desktop\New Folder\Store.Infrastructure\Data\Repositories.cs:line 122
   at Store.Services.ProductService.UpdateProductAsync(Int32 id, Product product) in C:\Users\acc\Desktop\New Folder\Store.Services\ProductService.cs:line 66
   at Store.API.Controllers.ProductsController.UpdateProduct(Int32 id, ProductCreateDto productDto) in C:\Users\acc\Desktop\New Folder\Store.API\Controllers\ProductsController.cs:line 78
   at lambda_method772(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Store.API.Middleware.SerilogUserEnricherMiddleware.InvokeAsync(HttpContext context) in C:\Users\acc\Desktop\New Folder\Store.API\Middleware\SerilogUserEnricherMiddleware.cs:line 21
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Store.API.Middleware.ExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\acc\Desktop\New Folder\Store.API\Middleware\ExceptionMiddleware.cs:line 24
[2025-12-27 15:14:35.054] [Store.API] [User: ] INF: Request finished HTTP/1.1 PUT http://localhost:5025/api/Products/6 - 500 null application/json 9.9837ms
[2025-12-27 15:17:19.698] [Store.API] [User: ] INF: Request starting HTTP/1.1 PUT http://localhost:5025/api/Products/6 - application/json 153
[2025-12-27 15:17:19.698] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:17:19.698] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:17:19.699] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:17:19.699] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "UpdateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.ProductToReturnDto]] UpdateProduct(Int32, Store.Application.Dtos.ProductCreateDto) on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:17:19.713] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (11ms) [Parameters=[@p='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CreatedBy], [p].[CreatedDate], [p].[Description], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name], [p].[PicturePublicId], [p].[PictureUrl], [p].[Price], [p].[ProductBrandId], [p].[ProductTypeId]
FROM [Products] AS [p]
WHERE [p].[Id] = @p
[2025-12-27 15:17:19.726] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (12ms) [Parameters=[@p13='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Products] SET [CategoryId] = @p0, [CreatedBy] = @p1, [CreatedDate] = @p2, [Description] = @p3, [IsDeleted] = @p4, [LastModifiedBy] = @p5, [LastModifiedDate] = @p6, [Name] = @p7, [PicturePublicId] = @p8, [PictureUrl] = @p9, [Price] = @p10, [ProductBrandId] = @p11, [ProductTypeId] = @p12
OUTPUT 1
WHERE [Id] = @p13;
[2025-12-27 15:17:19.727] [Store.API] [User: superadmin@store.com] ERR: An exception occurred in the database while saving changes for context type 'Store.Infrastructure.Data.StoreContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_ProductBrands_ProductBrandId". The conflict occurred in database "Store01", table "dbo.ProductBrands", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_ProductBrands_ProductBrandId". The conflict occurred in database "Store01", table "dbo.ProductBrands", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2025-12-27 15:17:19.727] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.UpdateProduct (Store.API) in 28.3253ms
[2025-12-27 15:17:19.727] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:17:19.727] [Store.API] [User: ] ERR: An unhandled exception has occurred while executing the request: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_ProductBrands_ProductBrandId". The conflict occurred in database "Store01", table "dbo.ProductBrands", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Store.Infrastructure.Data.UnitOfWork.Complete() in C:\Users\acc\Desktop\New Folder\Store.Infrastructure\Data\Repositories.cs:line 122
   at Store.Services.ProductService.UpdateProductAsync(Int32 id, Product product) in C:\Users\acc\Desktop\New Folder\Store.Services\ProductService.cs:line 66
   at Store.API.Controllers.ProductsController.UpdateProduct(Int32 id, ProductCreateDto productDto) in C:\Users\acc\Desktop\New Folder\Store.API\Controllers\ProductsController.cs:line 78
   at lambda_method772(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Store.API.Middleware.SerilogUserEnricherMiddleware.InvokeAsync(HttpContext context) in C:\Users\acc\Desktop\New Folder\Store.API\Middleware\SerilogUserEnricherMiddleware.cs:line 21
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Store.API.Middleware.ExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\acc\Desktop\New Folder\Store.API\Middleware\ExceptionMiddleware.cs:line 24
[2025-12-27 15:17:19.728] [Store.API] [User: ] INF: Request finished HTTP/1.1 PUT http://localhost:5025/api/Products/6 - 500 null application/json 30.6888ms
[2025-12-27 15:17:29.986] [Store.API] [User: ] INF: Request starting HTTP/1.1 PUT http://localhost:5025/api/Products/6 - application/json 153
[2025-12-27 15:17:29.986] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:17:29.986] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:17:29.986] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:17:29.986] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "UpdateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.ProductToReturnDto]] UpdateProduct(Int32, Store.Application.Dtos.ProductCreateDto) on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:17:29.991] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (3ms) [Parameters=[@p='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CreatedBy], [p].[CreatedDate], [p].[Description], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name], [p].[PicturePublicId], [p].[PictureUrl], [p].[Price], [p].[ProductBrandId], [p].[ProductTypeId]
FROM [Products] AS [p]
WHERE [p].[Id] = @p
[2025-12-27 15:17:29.998] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (6ms) [Parameters=[@p13='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Products] SET [CategoryId] = @p0, [CreatedBy] = @p1, [CreatedDate] = @p2, [Description] = @p3, [IsDeleted] = @p4, [LastModifiedBy] = @p5, [LastModifiedDate] = @p6, [Name] = @p7, [PicturePublicId] = @p8, [PictureUrl] = @p9, [Price] = @p10, [ProductBrandId] = @p11, [ProductTypeId] = @p12
OUTPUT 1
WHERE [Id] = @p13;
[2025-12-27 15:17:29.998] [Store.API] [User: superadmin@store.com] ERR: An exception occurred in the database while saving changes for context type 'Store.Infrastructure.Data.StoreContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_ProductBrands_ProductBrandId". The conflict occurred in database "Store01", table "dbo.ProductBrands", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_ProductBrands_ProductBrandId". The conflict occurred in database "Store01", table "dbo.ProductBrands", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2025-12-27 15:17:29.999] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.UpdateProduct (Store.API) in 12.6377ms
[2025-12-27 15:17:29.999] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:17:29.999] [Store.API] [User: ] ERR: An unhandled exception has occurred while executing the request: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Products_ProductBrands_ProductBrandId". The conflict occurred in database "Store01", table "dbo.ProductBrands", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:023c8f5c-fa43-477f-9fa8-bc60f43a83d1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Store.Infrastructure.Data.UnitOfWork.Complete() in C:\Users\acc\Desktop\New Folder\Store.Infrastructure\Data\Repositories.cs:line 122
   at Store.Services.ProductService.UpdateProductAsync(Int32 id, Product product) in C:\Users\acc\Desktop\New Folder\Store.Services\ProductService.cs:line 66
   at Store.API.Controllers.ProductsController.UpdateProduct(Int32 id, ProductCreateDto productDto) in C:\Users\acc\Desktop\New Folder\Store.API\Controllers\ProductsController.cs:line 78
   at lambda_method772(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Store.API.Middleware.SerilogUserEnricherMiddleware.InvokeAsync(HttpContext context) in C:\Users\acc\Desktop\New Folder\Store.API\Middleware\SerilogUserEnricherMiddleware.cs:line 21
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Store.API.Middleware.ExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\acc\Desktop\New Folder\Store.API\Middleware\ExceptionMiddleware.cs:line 24
[2025-12-27 15:17:30.001] [Store.API] [User: ] INF: Request finished HTTP/1.1 PUT http://localhost:5025/api/Products/6 - 500 null application/json 15.1966ms
[2025-12-27 15:20:23.868] [Store.API] [User: ] INF: Request starting HTTP/1.1 PUT http://localhost:5025/api/Products/6 - application/json 105
[2025-12-27 15:20:23.868] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:20:23.868] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:20:23.878] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:20:23.878] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "UpdateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.ProductToReturnDto]] UpdateProduct(Int32, Store.Application.Dtos.ProductCreateDto) on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:20:23.893] [Store.API] [User: superadmin@store.com] INF: Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
[2025-12-27 15:20:23.908] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.UpdateProduct (Store.API) in 30.1905ms
[2025-12-27 15:20:23.908] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:20:23.908] [Store.API] [User: ] INF: Request finished HTTP/1.1 PUT http://localhost:5025/api/Products/6 - 400 null application/problem+json; charset=utf-8 40.5164ms
[2025-12-27 15:21:48.519] [Store.API] [User: ] INF: Request starting HTTP/1.1 PUT http://localhost:5025/api/Products/6 - application/json 148
[2025-12-27 15:21:48.520] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:21:48.520] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:21:48.521] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:21:48.521] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "UpdateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.ProductToReturnDto]] UpdateProduct(Int32, Store.Application.Dtos.ProductCreateDto) on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:21:48.536] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (3ms) [Parameters=[@p='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CreatedBy], [p].[CreatedDate], [p].[Description], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name], [p].[PicturePublicId], [p].[PictureUrl], [p].[Price], [p].[ProductBrandId], [p].[ProductTypeId]
FROM [Products] AS [p]
WHERE [p].[Id] = @p
[2025-12-27 15:21:48.545] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (9ms) [Parameters=[@p13='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Products] SET [CategoryId] = @p0, [CreatedBy] = @p1, [CreatedDate] = @p2, [Description] = @p3, [IsDeleted] = @p4, [LastModifiedBy] = @p5, [LastModifiedDate] = @p6, [Name] = @p7, [PicturePublicId] = @p8, [PictureUrl] = @p9, [Price] = @p10, [ProductBrandId] = @p11, [ProductTypeId] = @p12
OUTPUT 1
WHERE [Id] = @p13;
[2025-12-27 15:21:48.546] [Store.API] [User: superadmin@store.com] INF: Executing OkObjectResult, writing value of type 'Store.Application.Dtos.ProductToReturnDto'.
[2025-12-27 15:21:48.546] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.UpdateProduct (Store.API) in 25.1866ms
[2025-12-27 15:21:48.546] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.UpdateProduct (Store.API)'
[2025-12-27 15:21:48.546] [Store.API] [User: ] INF: Request finished HTTP/1.1 PUT http://localhost:5025/api/Products/6 - 200 null application/json; charset=utf-8 26.4472ms
[2025-12-27 15:22:10.274] [Store.API] [User: ] INF: Request starting HTTP/1.1 DELETE http://localhost:5025/api/Products/6 - null null
[2025-12-27 15:22:10.275] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:22:10.275] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:22:10.275] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.DeleteProduct (Store.API)'
[2025-12-27 15:22:10.287] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "DeleteProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] DeleteProduct(Int32) on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:22:10.292] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (2ms) [Parameters=[@p='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CreatedBy], [p].[CreatedDate], [p].[Description], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name], [p].[PicturePublicId], [p].[PictureUrl], [p].[Price], [p].[ProductBrandId], [p].[ProductTypeId]
FROM [Products] AS [p]
WHERE [p].[Id] = @p
[2025-12-27 15:22:10.311] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (17ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Products]
OUTPUT 1
WHERE [Id] = @p0;
[2025-12-27 15:22:10.312] [Store.API] [User: superadmin@store.com] INF: Executing StatusCodeResult, setting HTTP status code 200
[2025-12-27 15:22:10.312] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.DeleteProduct (Store.API) in 24.6346ms
[2025-12-27 15:22:10.312] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.DeleteProduct (Store.API)'
[2025-12-27 15:22:10.312] [Store.API] [User: ] INF: Request finished HTTP/1.1 DELETE http://localhost:5025/api/Products/6 - 200 0 null 37.7712ms
[2025-12-27 15:22:17.233] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/api/Products/brands - null null
[2025-12-27 15:22:17.233] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.GetBrands (Store.API)'
[2025-12-27 15:22:17.244] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "GetBrands", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IReadOnlyList`1[Store.Application.Dtos.BrandDto]]] GetBrands() on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:22:17.255] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CreatedBy], [p].[CreatedDate], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name]
FROM [ProductBrands] AS [p]
[2025-12-27 15:22:17.259] [Store.API] [User: superadmin@store.com] INF: Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Store.Application.Dtos.BrandDto, Store.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-27 15:22:17.260] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.GetBrands (Store.API) in 16.3997ms
[2025-12-27 15:22:17.260] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.GetBrands (Store.API)'
[2025-12-27 15:22:17.261] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/api/Products/brands - 200 null application/json; charset=utf-8 27.7067ms
[2025-12-27 15:22:25.660] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/api/Products/types - null null
[2025-12-27 15:22:25.661] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.GetTypes (Store.API)'
[2025-12-27 15:22:25.667] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "GetTypes", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IReadOnlyList`1[Store.Application.Dtos.TypeDto]]] GetTypes() on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:22:25.683] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CreatedBy], [p].[CreatedDate], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name]
FROM [ProductTypes] AS [p]
[2025-12-27 15:22:25.687] [Store.API] [User: superadmin@store.com] INF: Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Store.Application.Dtos.TypeDto, Store.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-27 15:22:25.688] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.GetTypes (Store.API) in 20.145ms
[2025-12-27 15:22:25.688] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.GetTypes (Store.API)'
[2025-12-27 15:22:25.688] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/api/Products/types - 200 null application/json; charset=utf-8 27.2178ms
[2025-12-27 15:22:33.754] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/api/Products/categories - null null
[2025-12-27 15:22:33.755] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.GetCategories (Store.API)'
[2025-12-27 15:22:33.771] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "GetCategories", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IReadOnlyList`1[Store.Application.Dtos.CategoryDto]]] GetCategories() on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:22:33.777] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedBy], [c].[CreatedDate], [c].[Description], [c].[IsDeleted], [c].[LastModifiedBy], [c].[LastModifiedDate], [c].[Name]
FROM [Categories] AS [c]
[2025-12-27 15:22:33.778] [Store.API] [User: superadmin@store.com] INF: Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Store.Application.Dtos.CategoryDto, Store.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-27 15:22:33.778] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.GetCategories (Store.API) in 7.1994ms
[2025-12-27 15:22:33.778] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.GetCategories (Store.API)'
[2025-12-27 15:22:33.778] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/api/Products/categories - 200 null application/json; charset=utf-8 24.0512ms
[2025-12-27 15:23:07.286] [Store.API] [User: ] INF: Request starting HTTP/1.1 PUT http://localhost:5025/api/Products/6/photo - multipart/form-data; boundary=----WebKitFormBoundaryRc2EHXrOKV7Zpzy1 108825
[2025-12-27 15:23:07.289] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:23:07.289] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:23:07.289] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.AddProductPhoto (Store.API)'
[2025-12-27 15:23:07.305] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "AddProductPhoto", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.ProductToReturnDto]] AddProductPhoto(Int32, Microsoft.AspNetCore.Http.IFormFile) on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:23:07.342] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (2ms) [Parameters=[@p='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CreatedBy], [p].[CreatedDate], [p].[Description], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name], [p].[PicturePublicId], [p].[PictureUrl], [p].[Price], [p].[ProductBrandId], [p].[ProductTypeId]
FROM [Products] AS [p]
WHERE [p].[Id] = @p
[2025-12-27 15:23:07.343] [Store.API] [User: superadmin@store.com] INF: Executing BadRequestObjectResult, writing value of type 'Store.API.Errors.ApiResponse'.
[2025-12-27 15:23:07.344] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.AddProductPhoto (Store.API) in 38.8559ms
[2025-12-27 15:23:07.344] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.AddProductPhoto (Store.API)'
[2025-12-27 15:23:07.347] [Store.API] [User: ] INF: Request finished HTTP/1.1 PUT http://localhost:5025/api/Products/6/photo - 400 null application/json; charset=utf-8 61.2376ms
[2025-12-27 15:23:34.373] [Store.API] [User: ] INF: Request starting HTTP/1.1 PUT http://localhost:5025/api/Products/6/photo - multipart/form-data; boundary=----WebKitFormBoundaryaZa6PSGeXuQoiH80 982526
[2025-12-27 15:23:34.373] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:23:34.373] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:23:34.374] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.AddProductPhoto (Store.API)'
[2025-12-27 15:23:34.374] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "AddProductPhoto", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.ProductToReturnDto]] AddProductPhoto(Int32, Microsoft.AspNetCore.Http.IFormFile) on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:23:34.405] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (1ms) [Parameters=[@p='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CreatedBy], [p].[CreatedDate], [p].[Description], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name], [p].[PicturePublicId], [p].[PictureUrl], [p].[Price], [p].[ProductBrandId], [p].[ProductTypeId]
FROM [Products] AS [p]
WHERE [p].[Id] = @p
[2025-12-27 15:23:34.406] [Store.API] [User: superadmin@store.com] INF: Executing BadRequestObjectResult, writing value of type 'Store.API.Errors.ApiResponse'.
[2025-12-27 15:23:34.406] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.AddProductPhoto (Store.API) in 32.1638ms
[2025-12-27 15:23:34.406] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.AddProductPhoto (Store.API)'
[2025-12-27 15:23:34.407] [Store.API] [User: ] INF: Request finished HTTP/1.1 PUT http://localhost:5025/api/Products/6/photo - 400 null application/json; charset=utf-8 33.9372ms
[2025-12-27 15:23:52.422] [Store.API] [User: ] INF: Request starting HTTP/1.1 GET http://localhost:5025/api/Types - null null
[2025-12-27 15:23:52.423] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.TypesController.GetTypes (Store.API)'
[2025-12-27 15:23:52.440] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "GetTypes", controller = "Types"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IReadOnlyList`1[Store.Application.Dtos.TypeDto]]] GetTypes() on controller Store.API.Controllers.TypesController (Store.API).
[2025-12-27 15:23:52.447] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CreatedBy], [p].[CreatedDate], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name]
FROM [ProductTypes] AS [p]
[2025-12-27 15:23:52.447] [Store.API] [User: superadmin@store.com] INF: Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Store.Application.Dtos.TypeDto, Store.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-27 15:23:52.448] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.TypesController.GetTypes (Store.API) in 7.6401ms
[2025-12-27 15:23:52.448] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.TypesController.GetTypes (Store.API)'
[2025-12-27 15:23:52.448] [Store.API] [User: ] INF: Request finished HTTP/1.1 GET http://localhost:5025/api/Types - 200 null application/json; charset=utf-8 25.7121ms
[2025-12-27 15:25:54.486] [Store.API] [User: ] INF: Request starting HTTP/1.1 PUT http://localhost:5025/api/Products/5/photo - multipart/form-data; boundary=----WebKitFormBoundaryXD9ZeL5eB28EqGN0 982526
[2025-12-27 15:25:54.487] [Store.API] [User: ] INF: CORS policy execution failed.
[2025-12-27 15:25:54.487] [Store.API] [User: ] INF: Request origin http://localhost:5025 does not have permission to access the resource.
[2025-12-27 15:25:54.488] [Store.API] [User: superadmin@store.com] INF: Executing endpoint 'Store.API.Controllers.ProductsController.AddProductPhoto (Store.API)'
[2025-12-27 15:25:54.488] [Store.API] [User: superadmin@store.com] INF: Route matched with {action = "AddProductPhoto", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Store.Application.Dtos.ProductToReturnDto]] AddProductPhoto(Int32, Microsoft.AspNetCore.Http.IFormFile) on controller Store.API.Controllers.ProductsController (Store.API).
[2025-12-27 15:25:54.510] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (10ms) [Parameters=[@p='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CreatedBy], [p].[CreatedDate], [p].[Description], [p].[IsDeleted], [p].[LastModifiedBy], [p].[LastModifiedDate], [p].[Name], [p].[PicturePublicId], [p].[PictureUrl], [p].[Price], [p].[ProductBrandId], [p].[ProductTypeId]
FROM [Products] AS [p]
WHERE [p].[Id] = @p
[2025-12-27 15:26:01.623] [Store.API] [User: superadmin@store.com] INF: Executed DbCommand (16ms) [Parameters=[@p13='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Products] SET [CategoryId] = @p0, [CreatedBy] = @p1, [CreatedDate] = @p2, [Description] = @p3, [IsDeleted] = @p4, [LastModifiedBy] = @p5, [LastModifiedDate] = @p6, [Name] = @p7, [PicturePublicId] = @p8, [PictureUrl] = @p9, [Price] = @p10, [ProductBrandId] = @p11, [ProductTypeId] = @p12
OUTPUT 1
WHERE [Id] = @p13;
[2025-12-27 15:26:01.624] [Store.API] [User: superadmin@store.com] INF: Executing OkObjectResult, writing value of type 'Store.Application.Dtos.ProductToReturnDto'.
[2025-12-27 15:26:01.624] [Store.API] [User: superadmin@store.com] INF: Executed action Store.API.Controllers.ProductsController.AddProductPhoto (Store.API) in 7135.4741ms
[2025-12-27 15:26:01.624] [Store.API] [User: superadmin@store.com] INF: Executed endpoint 'Store.API.Controllers.ProductsController.AddProductPhoto (Store.API)'
[2025-12-27 15:26:01.625] [Store.API] [User: ] INF: Request finished HTTP/1.1 PUT http://localhost:5025/api/Products/5/photo - 200 null application/json; charset=utf-8 7138.6726ms
